<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chagall Bible Illustrations Gallery - Hebrew Bible E-Reader</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial,
          sans-serif;
        line-height: 1.6;
        color: #333;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }
      .container {
        background: white;
        border-radius: 10px;
        padding: 30px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }
      h1 {
        color: #667eea;
        text-align: center;
        margin-bottom: 10px;
        font-size: 2.5em;
      }
      .subtitle {
        text-align: center;
        color: #666;
        margin-bottom: 30px;
        font-style: italic;
      }
      .attribution {
        background: #f8f9fa;
        border-left: 4px solid #667eea;
        padding: 15px;
        margin: 20px 0;
        border-radius: 5px;
      }
      .attribution h2 {
        color: #667eea;
        margin-top: 0;
      }
      .attribution a {
        color: #667eea;
        text-decoration: none;
      }
      .attribution a:hover {
        text-decoration: underline;
      }
      .book-section {
        margin: 40px 0;
        padding: 20px 0;
        border-bottom: 2px solid #eee;
      }
      .book-section:last-child {
        border-bottom: none;
      }
      .book-title {
        color: #764ba2;
        font-size: 1.8em;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid #ddd;
      }
      .image-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }
      .image-card {
        background: #f9f9f9;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition:
          transform 0.3s,
          box-shadow 0.3s;
      }
      .image-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
      }
      .image-card img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        cursor: pointer;
      }
      .image-info {
        padding: 15px;
      }
      .image-title {
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
        font-size: 0.9em;
      }
      .image-description {
        color: #666;
        font-size: 0.85em;
        line-height: 1.4;
      }
      .chapter-placement {
        color: #764ba2;
        font-size: 0.8em;
        margin-top: 5px;
        font-style: italic;
        font-weight: 500;
      }
      .back-link {
        display: inline-block;
        margin-bottom: 20px;
        color: #667eea;
        text-decoration: none;
        font-weight: bold;
      }
      .back-link:hover {
        text-decoration: underline;
      }
      .stats {
        background: #f0f4ff;
        padding: 15px;
        border-radius: 8px;
        margin: 20px 0;
        text-align: center;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 20px;
        margin-top: 15px;
      }
      .stat-item {
        text-align: center;
      }
      .stat-number {
        font-size: 2em;
        color: #667eea;
        font-weight: bold;
      }
      .stat-label {
        color: #666;
        font-size: 0.9em;
      }

      /* Modal for full-size images */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.9);
        cursor: pointer;
      }
      .modal-content {
        margin: auto;
        display: block;
        max-width: 90%;
        max-height: 90%;
        position: relative;
        top: 50%;
        transform: translateY(-50%);
      }
      .modal-caption {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 700px;
        text-align: center;
        color: #ccc;
        padding: 10px 0;
        height: auto;
      }
      .close {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        cursor: pointer;
      }
      .close:hover {
        color: #fff;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <a href="index.html" class="back-link">‚Üê Back to Home</a>

      <h1>Marc Chagall Bible Illustrations</h1>
      <p class="subtitle">A Visual Journey Through the Hebrew Bible</p>

      <div class="attribution">
        <h2>Artwork Attribution</h2>
        <p>
          All Marc Chagall Bible illustrations shown here are courtesy of
          <a href="https://www.artchive.com/?s=chagall+bible" target="_blank">artchive.com</a>.
        </p>
        <p>
          These masterpieces by one of the 20th century's most celebrated artists bring the ancient
          texts to life with vibrant colors and dreamlike imagery.
        </p>
      </div>

      <div class="stats">
        <h3>Collection Overview</h3>
        <div class="stats-grid">
          <div class="stat-item">
            <div class="stat-number">150+</div>
            <div class="stat-label">Illustrations</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">14</div>
            <div class="stat-label">Biblical Books</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">1956-1977</div>
            <div class="stat-label">Creation Period</div>
          </div>
        </div>
      </div>

      <div id="gallery-content"></div>
    </div>

    <!-- Modal for displaying full-size images -->
    <div id="imageModal" class="modal">
      <span class="close">&times;</span>
      <img class="modal-content" id="modalImage" />
      <div id="modalCaption" class="modal-caption"></div>
    </div>

    <script>
      // Utility: Roman numeral to integer
      function romanToInt(roman) {
        if (!roman) return null;
        const values = { I: 1, V: 5, X: 10, L: 50, C: 100, D: 500, M: 1000 };
        let sum = 0;
        let prev = 0;
        for (let i = roman.length - 1; i >= 0; i--) {
          const c = roman[i];
          const val = values[c];
          if (!val) return null;
          if (val < prev) sum -= val; else sum += val;
          prev = val;
        }
        return sum || null;
      }

      // Extract a subject Book + Chapter reference from description text
      // Examples it handles:
      //   - "(Genesis XVIII, 16)" => Genesis 18
      //   - "(Exodus IX, 21-23)" => Exodus 9
      //   - "(Lamentations III:1-9)" => Lamentations 3
      //   - "(I Kings, X, 18-20)" => I Kings 10
      function extractSubjectRef(desc) {
        if (!desc) return null;
        // Grab the last parenthetical group which usually contains the ref
        const parenMatch = desc.match(/\(([^()]+)\)\s*$/);
        if (!parenMatch) return null;
        const inside = parenMatch[1];

        // Find a book name followed by a Roman numeral token
        // Accept optional commas/colons around the numeral and verses
        // Book names may include spaces (e.g., "I Kings", "Song of Songs")
        const refMatch = inside.match(/^(.*?)\s*[,\s]*([IVXLCDM]+)\b/i);
        if (!refMatch) return null;
        let bookRaw = refMatch[1].trim();
        const roman = (refMatch[2] || '').toUpperCase();
        const chapter = romanToInt(roman);
        if (!bookRaw || !chapter) return null;

        // Normalize some common book name variants
        // Keep existing spacing for books like "I Kings", "II Samuel", etc.
        const bookNorm = bookRaw
          .replace(/\bI\b\s*_/g, 'I ')
          .replace(/\bII\b\s*_/g, 'II ')
          .replace(/_/g, ' ')
          .replace(/\s+/g, ' ')
          .trim();

        return `${bookNorm} ${chapter}`;
      }

      const imageData = null; // legacy placeholder
      async function loadImageConfig() {
        const res = await fetch('chagall_download_config.json');
        const items = await res.json();
        const byBook = new Map();
        for (const it of items) {
          const book = it.book || 'General';
          if (!byBook.has(book)) byBook.set(book, []);
          byBook.get(book).push(it);
        }
        return byBook;
      }

        // Legacy static data removed
        Exodus: [
          {
            file: "chagall_moses_is_saved_from_the_waters_of_nile_by_pharaoh_.jpg",
            title: "Baby Moses Saved",
            desc: "Pharaoh's daughter finds Moses (Exodus II, 5-6)",
          },
          {
            file: "chagall_god_appears_to_moses_in_the_burning_bush_exodus_ii.jpg",
            title: "The Burning Bush",
            desc: "God calls Moses (Exodus III, 1-6)",
          },
          {
            file: "chagall_moses_meets_in_the_desert_his_brother_aaron_who_ca.jpg",
            title: "Moses Meets Aaron",
            desc: "Brothers reunited (Exodus IV, 27-28)",
          },
          {
            file: "chagall_moses_and_his_brother_come_to_pharaoh_and_claim_th.jpg",
            title: "Moses Before Pharaoh",
            desc: "Let my people go (Exodus V, 1-4)",
          },
          {
            file: "chagall_moses_casts_his_stick_that_transformed_into_a_snak.jpg",
            title: "Staff Becomes Snake",
            desc: "The miracle before Pharaoh (Exodus VII, 8-13)",
          },
          {
            file: "chagall_moses_spreads_the_darkness_over_egypt_exodus_ix_21.jpg",
            title: "Darkness Over Egypt",
            desc: "The ninth plague (Exodus IX, 21-23)",
          },
          {
            file: "chagall_the_israelites_which_have_gone_from_egypt_with_ang.jpg",
            title: "The Passover",
            desc: "Eating the paschal lamb (Exodus XII, 11-14)",
          },
          {
            file: "chagall_the_israelites_pass_the_red_sea_however_the_first_.jpg",
            title: "Crossing the Red Sea",
            desc: "Pharaoh's army drowns (Exodus XIV, 19-28)",
          },
          {
            file: "chagall_miriam_sister_of_moses_dances_with_her_friends_to_.jpg",
            title: "Miriam's Dance",
            desc: "Celebrating deliverance (Exodus XV, 19-21)",
          },
          {
            file: "chagall_moses_on_the_order_of_the_lord_has_struck_the_rock.jpg",
            title: "Water from the Rock",
            desc: "Moses strikes the rock at Horeb (Exodus XVII, 4-7)",
          },
          {
            file: "chagall_moses_receiving_the_tablets_of_the_law_from_god_on.jpg",
            title: "Receiving the Law",
            desc: "On Mount Sinai (Exodus XXIV, 15-18)",
          },
          {
            file: "chagall_moses_received_the_tablets_of_law_1956_france_by_m.jpg",
            title: "Tablets of the Law (1956)",
            desc: "The Ten Commandments",
          },
          {
            file: "chagall_moses_with_the_tablets_of_the_law_1956_france_by_m.jpg",
            title: "Moses with the Tablets (1956)",
            desc: "Bringing God's law to the people",
          },
          {
            file: "chagall_the_hebrews_adore_the_golden_calf_exodus_xxxii_7_1.jpg",
            title: "The Golden Calf",
            desc: "Israel's idolatry (Exodus XXXII, 7-10)",
          },
          {
            file: "chagall_in_rage_which_he_felt_to_the_idolatry_of_the_chose.jpg",
            title: "Moses Breaks the Tablets",
            desc: "Anger at idolatry (Exodus XXXII, 15-19)",
          },
          {
            file: "chagall_aaron_in_front_of_the_golden_candlestick_with_seve.jpg",
            title: "The Menorah",
            desc: "Aaron and the seven-branched lampstand",
          },
          {
            file: "chagall_moses_died_looking_to_the_promised_land_where_he_s.jpg",
            title: "Moses Views Promised Land",
            desc: "The end of the journey (Deuteronomy XXXIV, 1-5)",
          },
          {
            file: "chagall_joshua_receives_the_blessing_of_moses_deuteronomy_.jpg",
            title: "Joshua Blessed",
            desc: "Moses passes leadership (Deuteronomy XXXIV, 9)",
          },
          {
            file: "chagall_joshua_moses_successor_as_head_of_israel_is_prepar.jpg",
            title: "Joshua Prepares",
            desc: "To cross the Jordan (Joshua I, 1-6)",
          },
          {
            file: "chagall_the_israelites_go_over_jordan_following_of_the_ark.jpg",
            title: "Crossing the Jordan",
            desc: "Following the Ark (Joshua III, 3-6)",
          },
        ],
        Joshua: [
          {
            file: "chagall_joshua_prostrates_himself_before_the_angel_sword_b.jpg",
            title: "Joshua Meets the Commander",
            desc: "Angel with sword (Joshua V, 13-15)",
          },
          {
            file: "chagall_rahab_and_the_spies_of_jericho_1960_france_by_marc.jpg",
            title: "Rahab and the Spies (1960)",
            desc: "Protecting Israel's scouts",
          },
          {
            file: "chagall_under_the_walls_of_jericho_joshua_listens_god_s_or.jpg",
            title: "At Jericho's Walls",
            desc: "God's battle plan (Joshua VI, 3-5)",
          },
          {
            file: "chagall_near_gibeon_joshua_to_give_his_troops_time_to_gain.jpg",
            title: "Sun Stands Still",
            desc: "Joshua's miracle at Gibeon (Joshua X, 12-14)",
          },
          {
            file: "chagall_joshua_is_delivering_the_five_kings_of_canaan_to_i.jpg",
            title: "Five Kings Defeated",
            desc: "Victory over Canaan (Joshua X, 22-26)",
          },
          {
            file: "chagall_joshua_closes_the_book_of_law_that_he_has_just_rea.jpg",
            title: "Reading the Law",
            desc: "Joshua teaches Israel (Joshua VIII, 33-35)",
          },
          {
            file: "chagall_already_been_old_joshua_brings_together_the_israel.jpg",
            title: "Joshua's Farewell",
            desc: "Final words to Israel (Joshua XXIII, 14-16)",
          },
          {
            file: "chagall_josue_and_the_stone_of_sichem_c_1931_paris_france_.jpg",
            title: "Stone of Shechem",
            desc: "Memorial of the covenant",
          },
        ],
        Judges: [
          {
            file: "chagall_deborah_the_prophetess_urges_barak_to_raise_an_arm.jpg",
            title: "Deborah the Prophetess",
            desc: "Rallying Israel to battle (Judges IV, 4-9)",
          },
          {
            file: "chagall_manoah_and_his_wife_offering_a_sacrifice_saw_the_a.jpg",
            title: "Manoah's Sacrifice",
            desc: "Angel in the flame (Judges XIII, 17-23)",
          },
          {
            file: "chagall_samson_kills_a_young_lion_judges_xiv_5_6_c_1956_fr.jpg",
            title: "Samson and the Lion",
            desc: "Supernatural strength (Judges XIV, 5-6)",
          },
          {
            file: "chagall_delilah_cut_samson_s_hair_and_had_thus_deprived_hi.jpg",
            title: "Samson and Delilah",
            desc: "The betrayal (Judges XVI, 15-18)",
          },
          {
            file: "chagall_having_lingered_in_gaza_house_of_courtesan_and_wat.jpg",
            title: "Samson at Gaza",
            desc: "Carrying the city gates (Judges XVI, 1-3)",
          },
          {
            file: "chagall_prisoner_of_the_philistines_who_gouged_out_his_eye.jpg",
            title: "Samson's Final Act",
            desc: "Destroying the temple (Judges XVI, 28-30)",
          },
        ],
        "Samuel & Kings": [
          {
            file: "chagall_hannah_prays_to_the_lord_for_a_son_who_will_be_sam.jpg",
            title: "Hannah's Prayer",
            desc: "Praying for Samuel (I Samuel I, 9-11)",
          },
          {
            file: "chagall_the_young_samuel_the_priest_s_servant_heard_that_h.jpg",
            title: "Young Samuel Called",
            desc: "God calls in the night (I Samuel III, 1-4)",
          },
          {
            file: "chagall_samuel_is_pouring_anointing_oil_to_saul_s_head_in_.jpg",
            title: "Saul Anointed",
            desc: "First king of Israel (I Samuel IX, 27)",
          },
          {
            file: "chagall_by_beating_the_philistines_saul_killed_himself_by_.jpg",
            title: "Death of Saul",
            desc: "Falls on his sword (I Samuel XXXI, 2-6)",
          },
          {
            file: "chagall_david_killed_a_lion_that_threatened_his_flock_i_sa.jpg",
            title: "David and the Lion",
            desc: "Shepherd protector (I Samuel XVII, 34-36)",
          },
          {
            file: "chagall_david_sings_accompanying_himself_in_the_harp_befor.jpg",
            title: "David Plays for Saul",
            desc: "Soothing the troubled king (I Samuel XVI, 19-23)",
          },
          {
            file: "chagall_david_s_victory_over_goliath_i_samuel_xvii_48_51_c.jpg",
            title: "David and Goliath",
            desc: "The giant falls (I Samuel XVII, 48-51)",
          },
          {
            file: "chagall_david_with_the_head_of_goliath_comes_to_saul_i_sam.jpg",
            title: "David's Victory",
            desc: "Presenting Goliath's head (I Samuel XVII, 55-58)",
          },
          {
            file: "chagall_michal_saves_david_from_saul_1960_france_by_marc_c.jpg",
            title: "Michal Saves David (1960)",
            desc: "Escaping Saul's wrath",
          },
          {
            file: "chagall_having_heard_about_the_death_of_jonathan_his_close.jpg",
            title: "David Mourns Jonathan",
            desc: "Lamenting his friend (II Samuel I, 17-27)",
          },
          {
            file: "chagall_david_with_his_harp_1956_france_by_marc_chagall.jpg",
            title: "David with Harp (1956)",
            desc: "The sweet psalmist of Israel",
          },
          {
            file: "chagall_king_david_ii_samuel_vi_4_5_c_1956_france_by_marc_.jpg",
            title: "King David Dancing",
            desc: "Before the Ark (II Samuel VI, 4-5)",
          },
          {
            file: "chagall_the_ark_of_the_covenant_transported_to_jerusalem_p.jpg",
            title: "Ark to Jerusalem",
            desc: "David brings the Ark (II Samuel VI, 1-5)",
          },
          {
            file: "chagall_from_the_terrace_of_his_palace_david_sees_bathing_.jpg",
            title: "David Sees Bathsheba",
            desc: "The fateful glance (II Samuel XI, 2-3)",
          },
          {
            file: "chagall_david_and_bathsheba_1956_france_by_marc_chagall.jpg",
            title: "David and Bathsheba (1956)",
            desc: "The king's sin",
          },
          {
            file: "chagall_bathsheba_reminds_david_of_his_promise_to_appoint_.jpg",
            title: "Bathsheba's Request",
            desc: "Solomon to be king (I Kings I, 15-20)",
          },
          {
            file: "chagall_david_and_absalom_1956_france_by_marc_chagall.jpg",
            title: "David and Absalom (1956)",
            desc: "Father and rebellious son",
          },
          {
            file: "chagall_absalom_riding_on_a_mule_is_caught_by_the_hair_on_.jpg",
            title: "Absalom's Death",
            desc: "Caught in the oak (II Samuel 18:9)",
          },
          {
            file: "chagall_david_on_his_throne_hosts_his_rebellious_son_absal.jpg",
            title: "David Forgives Absalom",
            desc: "Reconciliation (II Samuel XIV, 28-33)",
          },
          {
            file: "chagall_driven_from_jerusalem_by_rebelled_again_absalom_da.jpg",
            title: "David Flees Jerusalem",
            desc: "Barefoot to Mount of Olives",
          },
          {
            file: "chagall_being_informed_about_absalom_s_death_which_has_bee.jpg",
            title: "David Grieves Absalom",
            desc: "A father's lament (II Samuel XIX, 1-4)",
          },
          {
            file: "chagall_david_freed_from_all_of_his_enemies_sings_a_hymn_o.jpg",
            title: "David's Victory Hymn",
            desc: "Praising God (II Samuel XXII)",
          },
          {
            file: "chagall_david_1956_france_by_marc_chagall.jpg",
            title: "David (1956)",
            desc: "Portrait of the king",
          },
          {
            file: "chagall_god_appears_to_solomon_in_a_dream_and_he_asked_him.jpg",
            title: "Solomon's Dream",
            desc: "Asking for wisdom (I Kings III, 5-9)",
          },
          {
            file: "chagall_solomon_is_proclaimed_a_king_of_israel_i_kings_i_3.jpg",
            title: "Solomon Crowned",
            desc: "New king of Israel (I Kings I, 32-40)",
          },
          {
            file: "chagall_solomon_1956_france_by_marc_chagall.jpg",
            title: "Solomon (1956)",
            desc: "The wise king",
          },
          {
            file: "chagall_solomon_on_the_throne_i_kings_x_18_20_c_1956_franc.jpg",
            title: "Solomon Enthroned",
            desc: "In royal splendor (I Kings X, 18-20)",
          },
          {
            file: "chagall_the_judgement_of_solomon_i_kings_iii_16_27_c_1956_.jpg",
            title: "Solomon's Judgment",
            desc: "The two mothers (I Kings III, 16-27)",
          },
          {
            file: "chagall_solomon_praying_in_the_temple_in_presence_of_the_c.jpg",
            title: "Solomon's Temple Prayer",
            desc: "Dedicating the Temple (I Kings VIII, 23-30)",
          },
          {
            file: "chagall_arrival_of_queen_sheba_to_jerusalem_i_kings_x_1_5_.jpg",
            title: "Queen of Sheba",
            desc: "Visiting Solomon (I Kings X, 1-5)",
          },
          {
            file: "chagall_elijah_met_at_the_gate_of_zarephath_a_widow_trying.jpg",
            title: "Elijah and the Widow",
            desc: "At Zarephath (I Kings XVII, 1-10)",
          },
          {
            file: "chagall_elijah_resurrects_the_son_of_the_widow_of_zarephat.jpg",
            title: "Elijah's Miracle",
            desc: "Raising the widow's son (I Kings XVII, 17-22)",
          },
          {
            file: "chagall_the_sacrifice_offered_by_elijah_is_consumed_by_the.jpg",
            title: "Fire from Heaven",
            desc: "Elijah's sacrifice (I Kings XVIII, 36-38)",
          },
          {
            file: "chagall_elijah_on_the_top_of_mount_carmel_announced_the_im.jpg",
            title: "Elijah on Carmel",
            desc: "Announcing rain (I Kings XVIII, 41-46)",
          },
          {
            file: "chagall_being_asleep_in_the_desert_where_he_had_retired_to.jpg",
            title: "Angel Feeds Elijah",
            desc: "In the wilderness (I Kings XIX, 5-8)",
          },
          {
            file: "chagall_the_lord_appears_to_elijah_at_the_entrance_to_the_.jpg",
            title: "Still Small Voice",
            desc: "God speaks to Elijah (I Kings XIX, 9-13)",
          },
          {
            file: "chagall_elijah_is_taken_to_heaven_in_a_chariot_of_fire_to_.jpg",
            title: "Elijah's Ascension",
            desc: "Chariot of fire (II Kings II, 9-12)",
          },
        ],
        Prophets: [
          {
            file: "chagall_isaiah_1956_france_by_marc_chagall.jpg",
            title: "Isaiah (1956)",
            desc: "The prophet of consolation",
          },
          {
            file: "chagall_a_seraph_purify_the_lips_of_isaiah_with_a_hot_coal.jpg",
            title: "Isaiah's Calling",
            desc: "Seraph with coal (Isaiah VI, 1-7)",
          },
          {
            file: "chagall_isaiah_s_oracle_on_the_ruins_of_babylon_isaiah_xii.jpg",
            title: "Oracle Against Babylon",
            desc: "Isaiah's prophecy (Isaiah XIII)",
          },
          {
            file: "chagall_isaiah_s_prayer_isaiah_lxiv_6_11_c_1956_france_by_.jpg",
            title: "Isaiah's Prayer",
            desc: "Interceding for Israel (Isaiah LXIV, 6-11)",
          },
          {
            file: "chagall_the_man_guided_by_the_lord_the_right_way_isaiah_lv.jpg",
            title: "The Right Path",
            desc: "Divine guidance (Isaiah LVIII, 8-11)",
          },
          {
            file: "chagall_jerusalem_has_been_freed_from_babylon_according_to.jpg",
            title: "Jerusalem Freed",
            desc: "Return from exile (Isaiah XIV, 1-7)",
          },
          {
            file: "chagall_the_forgiveness_of_god_is_announced_in_jerusalem_i.jpg",
            title: "God's Forgiveness",
            desc: "Mercy for Jerusalem (Isaiah LIV, 6-10)",
          },
          {
            file: "chagall_happy_future_of_jerusalem_have_found_favor_with_go.jpg",
            title: "Jerusalem's Future",
            desc: "Restoration promised (Isaiah LXII, 1-5)",
          },
          {
            file: "chagall_peace_and_glory_were_brought_to_jerusalem_with_the.jpg",
            title: "Peace and Glory",
            desc: "Jerusalem restored (Isaiah LII, 1-7)",
          },
          {
            file: "chagall_peace_and_the_further_reign_of_jerusalem_in_prophe.jpg",
            title: "Reign of Peace",
            desc: "Isaiah's vision (Isaiah II, 1-5)",
          },
          {
            file: "chagall_jeremiah_1956_france_by_marc_chagall.jpg",
            title: "Jeremiah (1956)",
            desc: "The weeping prophet",
          },
          {
            file: "chagall_jeremiah_received_gift_of_the_prophecy_jeremiah_i_.jpg",
            title: "Jeremiah's Call",
            desc: "Receiving prophecy (Jeremiah I, 4-10)",
          },
          {
            file: "chagall_jeremiah_thrown_into_a_prison_by_the_people_of_kin.jpg",
            title: "Jeremiah Imprisoned",
            desc: "By King Zedekiah (Jeremiah XXXVIII, 4-6)",
          },
          {
            file: "chagall_jerusalem_was_taken_by_nebuchadnezzar_as_the_proph.jpg",
            title: "Fall of Jerusalem",
            desc: "Nebuchadnezzar's conquest (Jeremiah XXI, 4-7)",
          },
          {
            file: "chagall_lamentations_of_jeremiah_lamentations_iii_1_9_c_19.jpg",
            title: "Lamentations",
            desc: "Jeremiah mourns (Lamentations III:1-9)",
          },
          {
            file: "chagall_the_vision_of_ezekiel_ezekiel_i_4_14_c_1956_france.jpg",
            title: "Ezekiel's Vision",
            desc: "The divine chariot (Ezekiel I, 4-14)",
          },
          {
            file: "chagall_the_calling_of_ezekiel_ezekiel_ii_8x_iii_3_c_1956_.jpg",
            title: "Ezekiel Called",
            desc: "Eating the scroll (Ezekiel II-III)",
          },
          {
            file: "chagall_prophet_daniel_with_lions_1956_france_by_marc_chag.jpg",
            title: "Daniel in Lions' Den (1956)",
            desc: "Divine protection",
          },
        ],
        Writings: [
          {
            file: "chagall_job_in_despair_1960_france_by_marc_chagall.jpg",
            title: "Job in Despair (1960)",
            desc: "The righteous sufferer",
          },
          {
            file: "chagall_job_praying_1960_france_by_marc_chagall.jpg",
            title: "Job Praying (1960)",
            desc: "Faith through trials",
          },
          {
            file: "chagall_ruth_gleaning_1960_france_by_marc_chagall.jpg",
            title: "Ruth Gleaning (1960)",
            desc: "In Boaz's field",
          },
          {
            file: "chagall_naomi_and_her_daughters_in_law_1960_france_by_marc.jpg",
            title: "Naomi and Daughters-in-law (1960)",
            desc: "Ruth's loyalty",
          },
          {
            file: "chagall_meeting_of_ruth_and_boaz_1960_france_by_marc_chaga.jpg",
            title: "Ruth Meets Boaz (1960)",
            desc: "Divine providence",
          },
          {
            file: "chagall_boaz_wakes_up_and_see_ruth_at_his_feet_1960_france.jpg",
            title: "Ruth at Boaz's Feet (1960)",
            desc: "The threshing floor",
          },
          {
            file: "chagall_ruth_at_the_feet_of_boaz_1960_france_by_marc_chaga.jpg",
            title: "Ruth and Boaz (1960)",
            desc: "A love story",
          },
          {
            file: "chagall_esther_1960_france_by_marc_chagall.jpg",
            title: "Esther (1960)",
            desc: "Queen of Persia",
          },
          {
            file: "chagall_ahasuerus_sends_vasthi_away_1960_france_by_marc_ch.jpg",
            title: "Vashti Banished (1960)",
            desc: "Making way for Esther",
          },
          {
            file: "chagall_song_of_songs_iii_1960_france_by_marc_chagall.jpg",
            title: "Song of Songs III (1960)",
            desc: "Love poetry",
          },
          {
            file: "chagall_song_of_songs_v_c_1965_france_by_marc_chagall.jpg",
            title: "Song of Songs V (1965)",
            desc: "The beloved",
          },
        ],
        "Angels & Visions": [
          {
            file: "chagall_an_angel_1956_france_by_marc_chagall.jpg",
            title: "An Angel (1956)",
            desc: "Divine messenger",
          },
          {
            file: "chagall_angel_in_paradise_1956_france_by_marc_chagall.jpg",
            title: "Angel in Paradise (1956)",
            desc: "Heavenly being",
          },
          {
            file: "chagall_angel_with_a_sword_1956_france_by_marc_chagall.jpg",
            title: "Angel with Sword (1956)",
            desc: "Guardian angel",
          },
          {
            file: "chagall_title_page_angel_1956_france_by_marc_chagall.jpg",
            title: "Title Page Angel (1956)",
            desc: "Blessing the work",
          },
          {
            file: "chagall_paradise_1960_france_by_marc_chagall.jpg",
            title: "Paradise (1960)",
            desc: "Garden of Eden",
          },
          {
            file: "chagall_the_face_of_israel_1960_france_by_marc_chagall.jpg",
            title: "Face of Israel (1960)",
            desc: "The chosen people",
          },
          {
            file: "chagall_untitled_the_cover_of_bible_1960_france_by_marc_ch.jpg",
            title: "Bible Cover (1960)",
            desc: "The sacred text",
          },
          {
            file: "chagall_self_portrait_with_a_palette_1955_france_by_marc_c.jpg",
            title: "Self Portrait (1955)",
            desc: "Chagall the artist",
          },
        ],
      };

      // Generate gallery HTML from dynamic config
      async function generateGallery() {
        const container = document.getElementById("gallery-content");
        const byBook = await loadImageConfig();
        // Canonical order for user-friendly browsing
        const bookOrder = [
          'Genesis','Exodus','Leviticus','Numbers','Deuteronomy',
          'Joshua','Judges','I_Samuel','II_Samuel','I_Kings','II_Kings','Isaiah','Jeremiah','Ezekiel',
          'Hosea','Joel','Amos','Obadiah','Jonah','Micah','Nahum','Habakkuk','Zephaniah','Haggai','Zechariah','Malachi',
          'Psalms','Proverbs','Job','Song_of_Songs','Ruth','Lamentations','Ecclesiastes','Esther','Daniel','Ezra','Nehemiah','I_Chronicles','II_Chronicles','General'
        ];
        const books = Array.from(byBook.keys()).sort((a,b)=>{
          const ai = bookOrder.indexOf(a);
          const bi = bookOrder.indexOf(b);
          if (ai === -1 && bi === -1) return a.localeCompare(b);
          if (ai === -1) return 1;
          if (bi === -1) return -1;
          return ai - bi;
        });

        let html = '';
        for (const book of books) {
          const images = byBook.get(book);
          html += `<div class="book-section">`;
          html += `<h2 class="book-title">${book.replaceAll('_',' ')}</h2>`;
          html += `<div class="image-grid">`;

          images.forEach((img) => {
            const subjectRef = extractSubjectRef(img.title);
            const placementText = subjectRef ? `<div class="chapter-placement">üìç ${subjectRef}</div>` : '';

            const safeTitle = img.title.replace(/'/g, "\\'");
            html += `
              <div class="image-card">
                <img src="images/${img.filename}" alt="${safeTitle}" onclick="openModal('images/${img.filename}', '${safeTitle}')" loading="lazy">
                <div class="image-info">
                  <div class="image-title">${img.title}</div>
                  <div class="image-description"></div>
                  ${placementText}
                </div>
              </div>
            `;
          });

          html += `</div></div>`;
        }

        container.innerHTML = html;
      }

      // Modal functionality
      function openModal(imgSrc, caption) {
        const modal = document.getElementById("imageModal");
        const modalImg = document.getElementById("modalImage");
        const captionText = document.getElementById("modalCaption");

        modal.style.display = "block";
        modalImg.src = imgSrc;
        captionText.innerHTML = caption;
      }

      // Close modal
      document.getElementsByClassName("close")[0].onclick = function () {
        document.getElementById("imageModal").style.display = "none";
      };

      document.getElementById("imageModal").onclick = function (event) {
        if (event.target.id === "imageModal") {
          this.style.display = "none";
        }
      };

      // Generate gallery immediately (no external placement dependency)
      generateGallery();
    </script>
  </body>
</html>
